name: 🐧 Linux Shell CI with Cowsay

on:
  push:
    branches: [main]

jobs:
  stage-hatch:
    name: 🥚 Hatch the Dragon
    runs-on: ubuntu-latest

    steps:
      - name: Install cowsay
        run: sudo apt-get update && sudo apt-get install -y cowsay

      - name: Show system info
        run: uname -a

      - name: Announce hatch
        run: cowsay "Stage 1: Hatch complete!"

  stage-test:
    name: 🔥 Test the Fire
    runs-on: ubuntu-latest
    needs: stage-hatch

    steps:
      - name: Install cowsay
        run: sudo apt-get update && sudo apt-get install -y cowsay

      - name: Simulate a test
        run: |
          echo "Running shell test..."
          echo "All tests passed ✔️"

      - name: Celebrate tests
        run: cowsay "Stage 2: Fire tests passed!"

  stage-deploy:
    name: 🛫 Fly the Dragon (Deploy)
    runs-on: ubuntu-latest
    needs: stage-test
    if: github.ref == 'refs/heads/main'

    steps:
      - name: Install cowsay
        run: sudo apt-get update && sudo apt-get install -y cowsay

      - name: Fake deploy
        run: |
          echo "Deploying with 🐧 Linux shell..."
          sleep 2
          echo "Deployment done 🚀"

      - name: Final cowsay
        run: cowsay -f tux "Stage 3: Deployed successfully!"
